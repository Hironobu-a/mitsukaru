# Nemielu プロジェクト 運営方針書

**文書種別**: CTO運営方針・技術戦略  
**作成日**: 2026年2月17日  
**対象読者**: 役員・経営層  
**担当**: CTO

---

## エグゼクティブサマリー

Nemieluは**眠気・覚醒度の測定・分析サービス**です。

**現状の最優先課題（Tech Debt）**:
詳細は `TECH_DEBT_ROADMAP.md` を参照してください。
1. **セキュリティ**: 過去に一部認証情報の追跡履歴あり（ローテーション必須）。
2. **基盤老朽化**: Laravel 8 (PHP 8.0) のサポート終了対応。
3. **技術刷新**: フロントエンド技術の統一化。

**今後の方針**:
**「安定運用の確保」と「段階的な技術刷新」**を並行して進めます。
- **Contractor**: テスト拡充と機能改修
- **CTO**: 基盤刷新とアーキテクチャ設計

---

## 1. プロジェクトの位置づけとビジョン

### 1.1 プロジェクト概要

| 項目 | 内容 |
|------|------|
| **サービス名** | Nemielu（ネミエル） |
| **提供価値** | 眠気・覚醒度の測定・分析による、個人のパフォーマンス最適化支援 |
| **主な機能** | PVTテスト、眠気アンケート、カフェイン記録、個人レポート、管理者向けユーザー管理 |
| **技術基盤** | Laravel 8 / PHP 8.0 / MySQL / Docker |

### 1.2 ビジネスドメインの理解

本サービスは以下のようなユーザー体験を提供しています：

- **測定**: PVT（反応時間）、眠気スケール（KSS）、睡眠時間（HOS）、図型クイズ（HER）など
- **分析**: 個人の傾向を数値化し、レポートとして可視化
- **記録**: カフェイン摂取、睡眠パターン（平日・休日）の記録
- **管理**: クライアント単位でのユーザー管理（B2B想定）

### 1.3 技術ビジョン（3年後）

- **安定性**: セキュリティパッチが継続的に提供される最新Laravelを利用
- **開発効率**: フロントエンドを1〜2種類の技術に統一し、新機能開発を加速
- **品質**: テストカバレッジ70%以上、CI/CDによる自動品質チェック
- **拡張性**: APIファーストな設計により、モバイルアプリや外部連携に対応可能

---

## 2. 現状分析とリスク評価

### 2.1 技術的負債の整理

| カテゴリ | 内容 | ビジネス影響 | 対応優先度 |
|----------|------|--------------|------------|
| **セキュリティ** | 認証情報の漏洩履歴、EOLフレームワーク | 不正アクセス、コンプライアンス違反 | 最優先 |
| **基盤** | Laravel 8 EOL（2023年1月） | 脆弱性対応不可、新規パッケージ利用困難 | 高 |
| **フロントエンド** | Tailwind/Bootstrap/Alpine/Vue混在 | 開発速度低下、バグ増加リスク | 中 |
| **テスト** | カバレッジ不足（一部機能にテストなし） | リグレッション、品質不安定 | 中 |
| **コード品質** | 命名規則不統一、デバッグコード残存 | 保守コスト増加 | 低 |

### 2.2 リスクマトリクス（役員向け）

```
影響度
  ↑
高 │ 【セキュリティ】認証情報漏洩  【基盤】Laravel EOL
  │     → 早急に対応が必要
  │
中 │ 【フロント】技術混在  【テスト】カバレッジ不足
  │     → 計画的に対応
  │
低 │ 【コード品質】命名・デバッグコード
  │     → 余裕があれば対応
  └────────────────────────────→ 発生確率
      低        中        高
```

### 2.3 強み（現状維持・活用）

- **Docker環境**: 開発環境の再現性が高く、オンボーディングが容易
- **CI/CD**: GitHub Actionsでテスト自動実行が稼働中
- **ドキュメント**: 開発ガイド、技術負債ロードマップが整備済み
- **テスト基盤**: 84テストケースが存在し、主要機能はカバー済み

---

## 3. 運営方針の基本原則

### 3.1 開発の優先順位ルール

1. **セキュリティ・安定性** > 新機能開発
2. **技術負債の返済** と **新機能開発** を **並行** で進める（負債のみに偏らない）
3. **テストを書いてから** 大規模変更を行う（リグレッション防止）
4. **段階的リリース** を原則とし、一括大型リリースを避ける

### 3.2 意思決定の基準

| 判断が必要な場面 | 基準 |
|------------------|------|
| 新機能の優先度 | ビジネス価値 × 技術的リスク で評価。基盤が不安定な場合は基盤を優先 |
| 技術選定 | 既存スタックとの整合性、学習コスト、コミュニティの活発さを考慮 |
| スケジュール調整 | 品質を犠牲にした納期短縮は行わない。スコープ調整で対応 |
| 外部委託 | ドキュメント整備済みの領域から委託。知識の属人化を防ぐ |

### 3.3 品質ゲート（リリース前チェック）

- [ ] 全テストが成功
- [ ] セキュリティスキャン（依存パッケージの脆弱性チェック）実施
- [ ] 本番環境と同等の環境での動作確認
- [ ] ロールバック手順の文書化

---

## 4. ロードマップ（1年計画）

### 4.1 四半期別の重点施策

```
2026 Q1（2月〜4月）
├── セキュリティ緊急対応（認証情報ローテーション、Git履歴クリーンアップ）
├── テストカバレッジ強化（70%目標）
└── デバッグコード・バックアップファイルの整理

2026 Q2（5月〜7月）
├── Laravel 8 → 9 アップグレード
├── フロントエンド統一の設計・方針確定
└── 新機能開発（ビジネス優先度に応じて）

2026 Q3（8月〜10月）
├── Laravel 9 → 10 アップグレード
├── フロントエンド統一の段階的実施（新規画面から）
└── API設計の見直し（将来のモバイル対応を見据えて）

2026 Q4（11月〜1月）
├── Laravel 10 → 11 アップグレード
├── フロントエンド統一の継続
└── 年間振り返り・次年度計画策定
```

### 4.2 スプリント運用（2週間スプリント想定）

| スプリント内の割合 | 目安 | 内容 |
|--------------------|------|------|
| 技術負債対応 | 40% | アップグレード、リファクタリング、テスト追加 |
| 新機能開発 | 40% | ビジネス要件に基づく機能追加・改善 |
| バグ修正・運用 | 15% | 障害対応、問い合わせ対応 |
| 調査・検証 | 5% | 新技術の検証、アーキテクチャ検討 |

※ 緊急時（セキュリティインシデント等）は上記を一時的に変更

---

## 5. 新機能開発のプロセス

### 5.1 開発フロー

```
【要件定義】→【設計レビュー】→【実装】→【テスト】→【コードレビュー】→【リリース】
     ↑              ↑                ↑
  ビジネス側     CTO/アーキテクト    品質ゲート
  との合意       の技術承認          必須
```

### 5.2 新機能の技術審査チェックリスト

新機能を着手する前に、以下を確認します：

| 項目 | 確認内容 |
|------|----------|
| 既存機能との整合性 | 同じパターン・規約で実装できるか |
| テスト方針 | 単体・結合・E2Eのどこまでカバーするか |
| パフォーマンス | 想定ユーザー数・データ量で問題ないか |
| セキュリティ | 認証・認可・入力検証は適切か |
| フロントエンド | 統一方針（Tailwind + Alpine）に準拠するか |

### 5.3 禁止事項（技術的デットライン）

- 本番環境の認証情報をコードやコミットに含める
- テストなしで本番にリリースする
- 技術負債ロードマップに反する技術選定（例：新規でBootstrapを追加する）
- ドキュメントを更新せずにアーキテクチャを変更する

---

## 6. メンテナンス・運用方針

### 6.1 定期実施項目

| 頻度 | 項目 | 担当 |
|------|------|------|
| 毎日 | 監視アラート確認、ログ確認 | 運用担当 |
| 毎週 | 依存パッケージの脆弱性チェック（`composer audit`） | 開発担当 |
| 毎月 | バックアップのリストアテスト、パフォーマンス確認 | 開発・運用 |
| 四半期 | 技術負債ロードマップの見直し、優先度の再評価 | CTO |

### 6.2 障害対応フロー

1. **検知**: 監視・ユーザー報告・ログ確認
2. **初動**: 影響範囲の特定、ステークホルダーへの連絡
3. **対応**: 原因調査、暫定対応（ロールバック等）、恒久対応
4. **事後**: ポストモーテム作成、再発防止策の実施

### 6.3 バックアップ・復旧

- データベース: 日次バックアップ（推奨）
- 設定・コード: Gitで管理、タグでリリース版を管理
- 復旧目標: RTO（目標復旧時間）48時間以内、RPO（目標復旧時点）24時間以内を目安に設計

---

## 7. リソース・体制

### 7.1 推奨体制（最小構成）

| 役割 | 負荷 | 主な責務 |
|------|------|----------|
| CTO / テックリード | 0.5人月〜 | 技術方針、アーキテクチャ、レビュー、優先度判断 |
| バックエンド開発 | 1人月〜 | Laravel開発、API、DB設計 |
| フロントエンド開発 | 0.5人月〜 | UI実装、フロント統一対応 |
| 運用・QA | 0.25人月〜 | 監視、テスト、リリース作業 |

※ 小規模チームの場合は兼務で対応可能

### 7.2 スキル要件

- **必須**: Laravel（またはPHP MVC）、SQL、Git、Dockerの基本
- **あると望ましい**: フロントエンド（Tailwind/Alpine）、テスト（PHPUnit）、CI/CD
- **育成方針**: ドキュメント（DEVELOPMENT_GUIDE.md等）を活用したオンボーディング、ペアプログラミングでの知識共有

---

## 8. 予算・コストの考え方（役員向け）

### 8.1 技術投資の分類

| 分類 | 例 | 性質 |
|------|-----|------|
| **必須投資** | セキュリティ対応、Laravelアップグレード | やらないとリスクが増大。優先して実施 |
| **効率化投資** | フロントエンド統一、テスト強化 | 中長期で開発コストを削減。計画的に実施 |
| **成長投資** | 新機能、API拡張 | ビジネス成長に直結。バランスよく実施 |

### 8.2 コスト削減時の優先度（逆順）

削減が必要な場合、**最後に削る**べきもの：

1. セキュリティ対応
2. バックアップ・監視
3. Laravelアップグレード（EOL対応）
4. テスト・CI/CD

**先に検討できる**もの：

- フロントエンド統一のスケジュール延長
- 新機能のスコープ縮小
- 一部のコード品質改善の先送り

---

## 9. ステークホルダーコミュニケーション

### 9.1 報告頻度と内容

| 対象 | 頻度 | 内容 |
|------|------|------|
| 役員 | 四半期 | ロードマップ進捗、リスク、次期方針、予算・リソース |
| プロダクトオーナー | 毎スプリント | リリース内容、技術的ブロッカー、優先度の提案 |
| 開発チーム | 毎週 | タスク状況、技術的課題、ナレッジ共有 |

### 9.2 エスカレーション基準

以下の場合は速やかに役員へ報告・相談：

- セキュリティインシデントの発生
- 本番障害でサービス停止が1時間以上
- 個人情報・認証情報の漏洩の可能性
- スケジュール遅延が2週間以上
- 技術的判断でビジネス方針と衝突する場合

---

## 10. 成功指標（KPI）

### 10.1 技術KPI

| 指標 | 現状 | 1年後目標 |
|------|------|-----------|
| テストカバレッジ | 約60% | 70%以上 |
| Laravelバージョン | 8（EOL） | 11（LTS） |
| フロントエンド技術数 | 4種類 | 2種類以下 |
| CI/CD成功率 | 稼働中 | 95%以上 |
| 重大脆弱性 | 要確認 | 0件 |

### 10.2 プロセスKPI

| 指標 | 目標 |
|------|------|
| リリース頻度 | 2週間に1回以上（継続的デリバリー） |
| 障害復旧時間 | 検知から4時間以内に暫定対応 |
| ドキュメント更新 | アーキテクチャ変更時に必ず更新 |

---

## 11. 付録：用語集（役員向け）

| 用語 | 説明 |
|------|------|
| **Laravel** | PHPのWebアプリケーションフレームワーク。Nemieluの基盤技術 |
| **EOL** | End of Life。サポート終了。セキュリティパッチが提供されなくなる |
| **技術的負債** | 過去の shortcuts や古い技術の蓄積。放置すると開発速度が落ち、リスクが増える |
| **CI/CD** | コード変更時に自動でテスト・デプロイする仕組み。品質とリリース速度を両立 |
| **PVT** | Psychomotor Vigilance Test。反応時間を測る覚醒度チェック |
| **KSS** | Karolinska Sleepiness Scale。主観的眠気の尺度 |

---

## 12. 関連ドキュメント

- [TECH_DEBT_ROADMAP.md](./TECH_DEBT_ROADMAP.md) - 技術的負債の詳細ロードマップ
- [TEAM_STRUCTURE.md](./TEAM_STRUCTURE.md) - チーム体制・役割分担
- [../2_Development_Environment/DEVELOPMENT_GUIDE.md](../2_Development_Environment/DEVELOPMENT_GUIDE.md) - 開発環境・運用ガイド
- [../2_Development_Environment/GETTING_STARTED.md](../2_Development_Environment/GETTING_STARTED.md) - 最初に読むべきガイド

---

**本ドキュメントは四半期ごとに見直し、プロジェクトの状況に応じて更新します。**

*最終更新: 2026年2月17日*
